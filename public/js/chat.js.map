{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/client/WebUi.ts","webpack:///./src/enum/SocketEvents.ts","webpack:///./src/client/ChatClient.ts","webpack:///./src/client/app.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","default","[object Object]","id","this","element","document","getElementById","callback","username","prompt","undefined","msg","strong","createElement","span","appendChild","createTextNode","user","content","appendMessage","img","classList","add","src","users","userList","innerHTML","forEach","chip","scrollTop","scrollHeight","elements","li","scrollDown","SocketEvents","SocketEvents_1","ui","socket","io","registerSocketEvents","registerFormEvents","connectFailMsg","disconnectMsg","on","CLIENT_CONNECT","namePrompt","emit","NEW_USER","WELCOME","appendBoldText","DISCONNECT","CONNECT_FAILED","USER_CONNECT","appendSimpleMessage","USER_DISCONNECT","MESSAGE","IMAGE","appendImage","CONNECTED_USERS","refreshUserList","form","addEventListener","event","message","reset","preventDefault","e","file","files","reader","FileReader","evt","result","readAsDataURL","ChatClient_1","WebUi_1","$","init"],"mappings":"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","file":"chat.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","import Ui from './Ui'\nimport ChatMessage from './ChatMessage'\nimport User from './User'\n\n/**\n * Chat ui implementation class.\n *\n * @author Daniel Peters\n * @version 1.0\n */\nexport default class WebUi implements Ui {\n  private element: HTMLDivElement\n\n  /**\n   * Constructor.\n   *\n   * @param id ID of the chat display element\n   */\n  constructor (id: string) {\n    this.element = document.getElementById(id) as HTMLDivElement\n  }\n\n  /**\n   * Get username using a prompt. Waits until user submits a valid username.\n   *\n   * @param callback Callback executed after user submits a valid name\n   */\n  namePrompt (callback: (name: string) => void): void {\n    let username = ''\n\n    do {\n      username = prompt('What\\'s your username?')\n    } while (username === '' || username === null || username === undefined)\n\n    callback(username)\n  }\n\n  /**\n   * Add a message with username in bold and message in lowercase.\n   *\n   * @param msg Chat message\n   */\n  appendSimpleMessage (msg: ChatMessage): void {\n    const strong = document.createElement('strong')\n    const span = document.createElement('span')\n    strong.appendChild(document.createTextNode(msg.user))\n    span.appendChild(document.createTextNode(msg.content))\n    this.appendMessage([strong, span])\n  }\n\n  /**\n   * Add a bold message to the chat area.\n   *\n   * @param msg Chat message\n   */\n  appendBoldText (msg: ChatMessage): void {\n    const strong = document.createElement('strong')\n    strong.appendChild(document.createTextNode(msg.content))\n    this.appendMessage([strong])\n  }\n\n  /**\n   *\n   * @param msg Chat message\n   */\n  appendImage (msg: ChatMessage): void {\n    const strong = document.createElement('strong')\n    const span = document.createElement('span')\n    const img = document.createElement('img')\n    img.classList.add('responsive-img')\n    img.src = msg.content\n    strong.appendChild(document.createTextNode(msg.user))\n    span.appendChild(document.createTextNode(': '))\n    this.appendMessage([strong, span, img])\n  }\n\n  /**\n   * Refresh logged on user list.\n   *\n   * @param users List of online users\n   */\n  refreshUserList (users: User[]): void {\n    const userList = document.getElementById('userList')\n    userList.innerHTML = ''\n    users.forEach(user => {\n      const chip = document.createElement('div')\n      chip.classList.add('chip')\n      chip.appendChild(document.createTextNode(user.name))\n      userList.appendChild(chip)\n    })\n  }\n\n  /**\n   * Scroll to the bottom of the chat.\n   */\n  private scrollDown (): void {\n    this.element.scrollTop = this.element.scrollHeight\n  }\n\n  /**\n   * Append an item to the messages collection.\n   *\n   * @param elements HTML elements\n   */\n  private appendMessage (elements: HTMLElement[]): void {\n    let li = document.createElement('li')\n    li.classList.add('collection-item')\n    elements.forEach(element => li.appendChild(element))\n    this.element.appendChild(li)\n    this.scrollDown()\n  }\n}\n","/**\n * Socket events enum.\n *\n * @author Daniel Peters\n * @version 1.0\n */\nexport enum SocketEvents {\n  CONNECTION = 'connection',\n  CLIENT_CONNECT = 'connect',\n  DISCONNECT = 'disconnect',\n  CONNECT_FAILED = 'connect_failed',\n  NEW_USER = 'new-user',\n  WELCOME = 'welcome',\n  USER_CONNECT = 'user-connect',\n  USER_DISCONNECT = 'user-disconnect',\n  CONNECTED_USERS = 'connected-users',\n  MESSAGE = 'message',\n  IMAGE = 'image'\n}\n","import Ui from './Ui'\nimport { SocketEvents } from '../enum/SocketEvents'\n\n/**\n * Chat client class.\n *\n * @author Daniel Peters\n * @version 1.1\n */\nexport default class ChatClient {\n  private ui: Ui\n\n  /**\n   * Constructor.\n   *\n   * @param ui Chat user interface\n   */\n  constructor (ui: Ui) {\n    this.ui = ui\n  }\n\n  /**\n   * Initialize all events.\n   */\n  init (): void {\n    const socket = io()\n    this.registerSocketEvents(socket)\n    this.registerFormEvents(socket)\n  }\n\n  /**\n   * Register all socket.io events.\n   *\n   * @param socket Socket instance\n   */\n  private registerSocketEvents (socket: SocketIOClient.Socket): void {\n    const connectFailMsg = { content: 'Connection Failed.', user: '' }\n    const disconnectMsg = { content: 'You have been disconnected. Trying to reconnect.', user: '' }\n\n    socket.on(SocketEvents.CLIENT_CONNECT, () => this.ui.namePrompt(name => socket.emit(SocketEvents.NEW_USER, name)))\n    socket.on(SocketEvents.WELCOME, msg => this.ui.appendBoldText(msg))\n    socket.on(SocketEvents.DISCONNECT, () => this.ui.appendBoldText(disconnectMsg))\n    socket.on(SocketEvents.CONNECT_FAILED, () => this.ui.appendBoldText(connectFailMsg))\n    socket.on(SocketEvents.USER_CONNECT, msg => this.ui.appendSimpleMessage(msg))\n    socket.on(SocketEvents.USER_DISCONNECT, msg => this.ui.appendSimpleMessage(msg))\n    socket.on(SocketEvents.MESSAGE, msg => this.ui.appendSimpleMessage(msg))\n    socket.on(SocketEvents.IMAGE, msg => this.ui.appendImage(msg))\n    socket.on(SocketEvents.CONNECTED_USERS, users => this.ui.refreshUserList(users))\n  }\n\n  /**\n   * Register all form submit and change events.\n   *\n   * @param socket Socket instance\n   */\n  private registerFormEvents (socket: SocketIOClient.Socket): void {\n    const form = document.getElementById('chatForm') as HTMLFormElement\n    form.addEventListener('submit', event => {\n      const message = (document.getElementById('newMessage') as HTMLInputElement).value\n      socket.emit(SocketEvents.MESSAGE, message)\n      form.reset()\n      event.preventDefault()\n    })\n\n    // Waiting for user to submit message\n    document.getElementById('imageSubmit').addEventListener('change', e => {\n      const file = (document.getElementById('image') as HTMLInputElement).files[0]\n      const reader = new FileReader()\n      reader.addEventListener('load', evt => socket.emit(SocketEvents.IMAGE, { img: reader.result }))\n      reader.readAsDataURL(file)\n      e.preventDefault()\n    })\n  }\n}\n","import ChatClient from './ChatClient'\nimport WebUi from './WebUi'\n\ndocument.addEventListener('DOMContentLoaded', event => {\n  $('.dropify')['dropify']()\n\n  const ui = new WebUi('messages')\n  const client = new ChatClient(ui)\n  client.init()\n})\n"],"sourceRoot":""}